# Item Editor - Qt6 Migration Project

## Project Overview

This project is migrating the **Item Editor** application from C# WinForms to Qt6. The Item Editor is a specialized tool for editing game item databases in OTB (Open Tibia Binary) format, used by game developers working with Open Tibia-style MMORPG item systems.

## Key Information

- **Original Language**: C# (.NET Framework with WinForms)
- **Target Language**: C++17 with Qt6 framework
- **License**: MIT (as specified in LICENSE file)
- **Supported Game Versions**: 8.00 - 10.77
- **File Formats**: OTB (server), DAT/SPR (client)
- **Build System**: CMake with cross-platform support
- **Plugin Architecture**: Qt6 plugin system with QPluginLoader

## Project Structure

### Core Directories
- **`Legacy_App/csharp/`** - Original C# WinForms application (reference implementation)
  - `Source/` - Main application source code
  - `Source/PluginInterface/` - Plugin system interface
  - `Source/Host/` - Plugin hosting services
  - `ThirdParty/DarkUI/` - Dark theme UI library
- **`qt6_project/`** - Qt6 migration implementation
  - `src/` - Main application source with exact structural mirroring
  - `plugins/` - Plugin implementations (PluginOne, PluginTwo, PluginThree)
  - `docs/` - Migration guides and documentation
  - `tests/` - Unit and integration tests
- **`documentation/`** - Complete UI documentation and analysis
- **`tasks/`** - Task management and migration tracking
- **`production/`** - Production build artifacts and deployment

### Qt6 Source Structure
```
qt6_project/src/
├── main.cpp                    # Application entry point (Program.cs equivalent)
├── MainForm.cpp/.h/.ui        # Main window (MainForm.cs equivalent)
├── Controls/                  # Custom Qt widgets (exact mirror of C# Controls/)
├── Dialogs/                   # Dialog windows (exact mirror of C# Dialogs/)
├── Helpers/                   # Utility classes (exact mirror of C# Helpers/)
├── Host/                      # Plugin hosting (exact mirror of C# Host/)
├── PluginInterface/           # Plugin system (exact mirror of C# PluginInterface/)
└── Properties/                # Application metadata (C# Properties/ equivalent)
```

## Development Environment

### Required Tools and Setup
- **Qt6** (6.5+) with Core, Widgets, Gui, Network, Xml modules
- **CMake** (3.16+) for cross-platform builds
- **C++17** compatible compiler (MSVC 2019+, GCC 9+, Clang 10+)

### MCP Tools Configuration
The project uses several MCP (Model Context Protocol) tools for development:
- **context7-mcp** - Code documentation (use "qt-6-docs" for Qt6 framework documentation)
- **desktop-commander** - Code navigation and file operations  
- **shrimp-task-manager** - Task planning and implementation tracking
- **clear-thought-mcp-server** - Step-by-step reasoning for complex problems

### Task Management
- Tasks defined in `tasks/tasks.json` with structured tracking
- Web GUI available at `http://localhost:1507?lang=en` for task tracking
- Migration follows dependency-based execution order

## Build Instructions

### Quick Start
```bash
# Configure build
cmake -B build -S qt6_project -DCMAKE_PREFIX_PATH=/path/to/qt6

# Build application
cmake --build build

# Run application
./build/src/ItemEditor
```

### Build Configuration
- **Debug**: Development builds with debugging symbols
- **Release**: Optimized production builds
- **Cross-Platform**: Windows (primary), Linux, macOS support

## Coding Standards and Conventions

### Naming Conventions
- **Classes**: PascalCase (e.g., `ClientItemView`, `ServerItemListBox`)
- **Methods**: camelCase (e.g., `getClientItem()`, `loadPlugin()`)
- **Member Variables**: m_camelCase (e.g., `m_clientItem`, `m_pluginPath`)
- **Files**: Match class names (e.g., `ClientItemView.cpp`, `ClientItemView.h`)
- **Namespaces**: Use `ItemEditor` namespace for all project classes

### Code Organization
- **Header Guards**: Use `#pragma once` or `#ifndef` include guards
- **CMake Structure**: Each directory has its own `CMakeLists.txt`
- **Forward Declarations**: Minimize includes with forward declarations
- **Qt6 Patterns**: Use modern Qt6 signal/slot syntax and best practices

### Qt6 Development Standards
- **Signal/Slot Syntax**: Use modern syntax `connect(sender, &Class::signal, receiver, &Class::slot)`
- **Resource Management**: Use Qt's parent-child ownership model for QObjects
- **Memory Management**: Use smart pointers for non-QObject classes
- **Plugin System**: Use `Q_DECLARE_INTERFACE` and `QPluginLoader`

## Migration Strategy

### Architectural Fidelity
- **Exact Structural Mirroring**: Every C# directory has corresponding Qt6 directory
- **Component Mapping**: Every C# class has corresponding Qt6 class with same name
- **Functional Parity**: Maintain all original functionality while leveraging Qt6 features

### Technology Stack Migration
- **UI Framework**: WinForms → Qt6 Widgets
- **Theme System**: DarkUI → Qt6 Styling/Themes
- **Plugin System**: .NET Assembly loading → QPluginLoader
- **Data Types**: .NET types → Qt6/STL equivalents

### Core Component Mappings
- **MainForm → QMainWindow**
- **UserControl → QWidget**
- **ListBox → QListWidget**
- **Graphics.DrawImage() → QPainter::drawPixmap()**
- **Assembly.LoadFrom() → QPluginLoader**

## Plugin Architecture

### Qt6 Plugin System
- **Interface Definition**: `Q_DECLARE_INTERFACE` for plugin contracts
- **Plugin Loading**: `QPluginLoader` for dynamic loading
- **Service Architecture**: Qt service provider pattern
- **Version Management**: Maintain backward compatibility with C# plugins

### Plugin Development
- Inherit from `IPlugin` interface
- Implement all required virtual methods
- Use `Q_OBJECT` macro for Qt meta-object system
- Export plugin using `Q_PLUGIN_METADATA`

## Testing Strategy

### Test Categories
- **Unit Tests**: Test individual classes and functions in isolation
- **Integration Tests**: Test plugin system and component interactions
- **UI Tests**: Test dialog functionality and user interactions
- **Cross-Platform Tests**: Ensure compatibility across target platforms

### Test Framework
- Qt Test Framework for all testing
- Mock objects for external dependencies
- Test data stored in `qt6_project/tests/data/`
- Comprehensive plugin test suite included

## File Format Support

### Core Formats
- **OTB** - Open Tibia Binary (server item database)
- **DAT** - Client data files (item definitions)
- **SPR** - Sprite files (item graphics)

### Migration Considerations
- Maintain binary compatibility with existing files
- Preserve all editing capabilities
- Ensure cross-platform file handling
- Optimize performance for large datasets

## Documentation

### Essential Documentation
- **`documentation/UI_Documentation_Complete.md`** - Complete legacy UI analysis
- **`qt6_project/docs/MIGRATION_GUIDE.md`** - Detailed migration strategy
- **`qt6_project/docs/BUILD_INSTRUCTIONS.md`** - Build setup and troubleshooting
- **`qt6_project/docs/COMPONENT_MAPPING.md`** - C# to Qt6 component mappings
- **`qt6_project/README.md`** - Qt6 implementation overview

### Code Documentation
- Use Doxygen-style comments for API documentation
- Document migration decisions and rationale
- Maintain comprehensive class and method documentation

## Current Status

### Completed Components
- ✅ **Helper Classes** - PathHelper, FileNameHelper, Utils (Foundation)
- ✅ **Plugin Interface** - Core plugin system architecture
- ✅ **Plugin Host** - Plugin loading and management services
- ✅ **Build System** - CMake configuration and cross-platform support

### In Progress
- **Main Form** - Primary application window
- **Custom Controls** - ClientItemView, ServerItemListBox
- **Dialog Windows** - About, Preferences, Find Item forms

### Performance Optimizations
- Critical performance issues identified and resolved
- Plugin loading optimization implemented
- Memory management improvements in BitmapLocker
- UI responsiveness enhancements in ServerItemListBox

## External Resources

- **Qt6 Documentation**: Use context7-mcp "qt-6-docs" for framework reference
- **CMake Documentation**: Build system configuration
- **Open Tibia Formats**: OTB/DAT/SPR file specifications
- **C++17 Reference**: Modern C++ standards and best practices

## Development Workflow

### Getting Started
1. Review detailed migration documentation in `qt6_project/docs/`
2. Set up development environment with Qt6 and CMake
3. Access task management GUI at `http://localhost:1507?lang=en`
4. Begin with foundation components, then move to UI components

### Best Practices
- Always use Context7 MCP for Qt6 documentation lookup
- Use shrimp-task-manager for planning and tracking implementation
- Follow exact architectural mirroring of C# codebase
- Test components thoroughly with provided test framework
- Document all migration decisions and implementation details

---

*This guide is actively maintained and updated as the migration progresses. Check task status via the web GUI for current development state.*